from math import log2
from egz3atesty import runtests

def binsearch(A,x):
    n=len(A)
    i=0
    j=n-1

    while i<=j:
        q=(i+j)//2
        if A[q]==x:
            return q
        if A[q]>x:
            j=q-1
        else:
            i=q+1
    return i

def snow( I,T ):
    n=len(T)
    R=[]
    for i in range(n):
        R.append(T[i][0])
        R.append(T[i][1])

    R.sort()
    A=[R[0]]
    for i in range(1,2*n):
        if R[i]!=R[i-1]:
            A.append(R[i])
    
    n=len(A)
    _n=1<<(1+int(log2(n-1)))
    print(n,_n)

    ST=[0 for _ in range(2*_n)]

    def query(a):
        sum=0
        a+=_n
        while a>0:
            sum+=ST[a]
            a//=2
        return sum
    
    def update(a,b,c):
        a=binsearch(A,a)
        b=binsearch(A,b)
        a+=_n
        b+=_n

        while a<=b:
            if a%2==1:
                ST[a]+=c
                a+=1
            if b%2==0:
                ST[b]+=c
                b-=1
            a//=2
            b//=2
    m=len(T)
    for i in range(m):
        update(T[i][0],T[i][1],1)
    
    maxi=0
    for i in range(n):
        maxi=max(maxi,query(i))
    return maxi
# runtests( snow, all_tests = True )
T = 1000
I = [(851, 856), (206, 745), 
     (375, 852), (58, 749), (936, 971), (161, 382), (479, 924), (29, 410), 
     (331, 672), (302, 953), (799, 956), (293, 306), (443, 472), (238, 409), 
     (204, 655), (202, 877), (264, 907), (22, 985), (52, 607), (141, 842), 
     (123, 272), (758, 809), (228, 231), (253, 658), (3, 208), (6, 985), (47, 884), 
     (130, 141), (427, 776), (110, 881), (836, 967), (61, 98), (35, 888), (406, 881), 
     (220, 855), (109, 514), (560, 835), (534, 937), (164, 943), (706, 941), (667, 856), 
     (697, 782), (172, 879), (253, 706), (371, 880), (14, 801), (780, 887), (538, 877), (291, 560), 
     (406, 681), (375, 668), (274, 301), (451, 624), (417, 990), (228, 471), (306, 733), (0, 283), (822, 913),
       (476, 671), (538, 701), (336, 771), (326, 793), (567, 756), (861, 866), (75, 272), (78, 841), (156, 831), 
       (861, 874), (379, 688), (385, 542), (319, 492), (634, 821), (0, 227), (481, 694), (23, 492), (53, 202), (523, 800),
         (153, 374), (60, 919), (101, 850), (203, 288), (78, 249), (295, 964), (133, 770), (131, 600), (374, 649), (236, 455), 
         (698, 837), (219, 264), (273, 790), (831, 956), (458, 669), (256, 883), (326, 553), (84, 911), (682, 829), (328, 835),
        (366, 409), (228, 839), (253, 970)]
T = 100
I = [(3, 10), (0, 5), (20, 30), (25, 35), (26, 26)]
print(snow(T,I))


